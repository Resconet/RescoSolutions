(this["webpackJsonphouston-mobile-app"]=this["webpackJsonphouston-mobile-app"]||[]).push([[0],Array(79).concat([function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,,function(e,t,n){},,,,,,,,,,,,,,,,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var c,a=n(1),r=n.n(a),i=n(20),s=n.n(i),o=n(7),u=n(24),l=Object(u.b)("SET_SELECTED_EQUIPMENT"),d=Object(u.b)("SET_SELECTED_GUIDE"),b=Object(u.b)("SET_SELECTED_MODEL"),j=Object(u.b)("SET_ZOOM_ANNOTATION"),f=Object(u.b)("SET_EQUIPMENT"),m=Object(u.b)("SET_CATEGORIES"),p=Object(u.b)("SET_IMAGES_FOR_SAVE"),h=Object(u.b)("SET_PDFVIEWEROBJECT"),v=Object(u.c)({selectedEquipment:null,selectedGuide:null,selectedModel:null,zoomAnnotation:null,equipment:[],categories:[],imagesToSave:[]},(function(e){e.addCase(l,(function(e,t){e.selectedEquipment=t.payload})),e.addCase(d,(function(e,t){e.selectedGuide=t.payload})),e.addCase(j,(function(e,t){e.zoomAnnotation=t.payload})),e.addCase(f,(function(e,t){e.equipment=t.payload})),e.addCase(m,(function(e,t){e.categories=t.payload})),e.addCase(p,(function(e,t){e.imagesToSave=t.payload})),e.addCase(b,(function(e,t){e.selectedModel=t.payload})),e.addCase(h,(function(e,t){e.pdfViewerObject=t.payload}))})),O=Object(u.a)({reducer:v}),x=n(2),g=n.n(x),w=n(5),_=n(3),N=n(41),k=n(85),C=n.n(k),y=(n(75),n(115),n(116),n(117),window.MobileCRM),I=function(){y.Application.synchronizeOnForeground(!1)},S=(n(118),n(36)),P=function(e){return new Promise((function(t,n){e?MobileCRM.bridge.command("scanBarcode",JSON.stringify(e),(function(e){t(e[0])}),(function(e){n(e)})):MobileCRM.Platform.scanBarCode((function(e){t(e[0])}),(function(e){n(e)}))}))},M=window.MobileCRM,E=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P({ScannerTitle:"Login with QR",ScannerDescription:"Place the QR code inside the area. Scanning will start automatically.",IsSquareShown:!0});case 2:return t=e.sent,n=U(t),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){return new Promise((function(e,t){M.Configuration.requestObject((function(t){e(!t.settings.isDemoUser)}),(function(e){t(e)}))}))},T=function(e){return new Promise((function(t){M.Configuration.requestObject((function(n){M.Platform.requestObject((function(c){n.settings.canUsePassword||n.settings.isDemoUser||void 0===c.deviceIdentifier?t(e()):M.bridge.onGlobalEvent("ConfigChanged",(function(n){n.settings.canUsePassword&&t(e())}),!0)}),(function(){}))}))}))},U=function(e){var t,n={url:"",userName:"",password:"",savePassword:!0},c=e.split(/\r\n|\n|\r/),a=Object(S.a)(c);try{for(a.s();!(t=a.n()).done;){var r=t.value,i=[r.split("=")[0],r.substring(r.indexOf("=")+1)];switch(i[0]){case"Url":n.url=F(i[1]);break;case"UserName":n.userName=i[1];break;case"Password":n.password=i[1]}}}catch(s){a.e(s)}finally{a.f()}return n},F=function(e){return e.includes("/")?e:e.startsWith("@")?"https://dev-houston.resco.net/".concat(e.split("@")[1]):"https://houston.resco.net/".concat(e)},L=n(28),B=n.n(L),R=(n(137),n(9)),A=(n(139),n.p+"static/media/chevron-right.771f5536.svg"),D=(n(140),n(0)),G=function(e){var t=e.children,n=e.onPress,c=e.disabled,a=e.theme,r="button ".concat("selected"===a&&"button--selected"," ").concat("minimal"===a&&"button--minimal"," ").concat("inverted"===a&&"button--inverted"," ").concat(c&&"button--disabled");return Object(D.jsx)("div",{className:r,onClick:n,children:t})};!function(e){e[e.Landscape=0]="Landscape",e[e.Portrait=1]="Portrait"}(c||(c={}));var H,W=function(){return z()===c.Portrait?Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)>500:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)>500},z=function(){return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)>Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)?c.Landscape:c.Portrait},V=function(){var e=Object(a.useState)(z()),t=Object(_.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e;e=function(e){c(e)},window.addEventListener("resize",(function(){e(z())}))})),n},X=function(){var e=Object(a.useContext)(ne),t=Object(a.useContext)(xn),n=Object(a.useContext)(ce),r=n.setMail,i=n.setOrganization,s=n.setPassword,o=function(){var t=Object(w.a)(g.a.mark((function t(){var n,c,a,o;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E();case 2:n=t.sent,c=n.userName,a=n.url,o=n.password,r(c),i(a),s(o),e("login-screen");case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),u=V(),l=Object(a.useMemo)((function(){return W()&&u===c.Landscape}),[u]),d=Object(a.useMemo)((function(){return l?Object(D.jsxs)("h1",{className:"welcome-screen__h1 --tablet",children:[Object(D.jsx)("span",{className:"welcome-screen--text-dark",children:"Hello."}),Object(D.jsx)("br",{}),"This is Houston."]}):Object(D.jsxs)("h1",{className:"welcome-screen__h1",children:[Object(D.jsx)("span",{className:"welcome-screen--text-dark",children:"Hello."}),Object(D.jsx)("br",{}),"This is",Object(D.jsx)("br",{}),"Houston."]})}),[l]);return Object(D.jsxs)("div",{className:"welcome-screen__container ".concat(l&&"--tablet"),children:[Object(D.jsxs)("div",{className:"welcome-screen__container-text ".concat(l&&"--tablet"),children:[d,Object(D.jsx)("hr",{className:"welcome-screen__separator"}),Object(D.jsx)("p",{className:"welcome-screen__p",children:"A smart app for smart workers."})]}),Object(D.jsxs)("div",{className:"welcome-screen__container-buttons ".concat(l&&"--tablet"),children:[Object(D.jsx)(G,{onPress:o,children:"Login with QR code"}),Object(D.jsx)(G,{onPress:function(){e("login-screen")},children:"Login with email"}),Object(D.jsxs)("span",{className:"welcome-screen__demo-data",onClick:function(){t("main-navigator")},children:["Use demo data",Object(D.jsx)(R.a,{src:A})]})]})]})},Y=(n(142),n.p+"static/media/chevron-left.4a82e7f7.svg"),Q=n.p+"static/media/qr-scan.162ace23.svg",J=(n(143),function(e){var t=e.value,n=e.onChange,c=e.label,r=e.placeholder,i=e.type,s=e.theme,o=e.multiline,u=e.noMargin,l=e.startCapital,d=e.maxLength,b=Object(a.useState)(!1),j=Object(_.a)(b,2),f=j[0],m=j[1],p="password"===i,h=function(e){var t=e.target.value;n(t)},v=function(){document.body.style.overflow="hidden"},O=function(){document.body.style.overflow="initial"};return Object(D.jsxs)("div",{className:"text-input__container text-input__container".concat("light"===s?"--light":"--dark"),style:u?{marginBottom:"1.2rem"}:{},children:[o?Object(D.jsx)("textarea",{className:"text-field",value:t,placeholder:r,onChange:h,onInput:function(e){var t=e.target;t.style.height=e.target.offsetHeight.toString(),t.style.height=t.scrollHeight+1.3+"px"},onFocus:v,onBlur:O,required:!0,maxLength:d}):Object(D.jsx)("input",{className:"text-input",value:t,placeholder:r,onChange:h,onFocus:v,onBlur:O,type:f?"text":i,autoCapitalize:l?"on":"none",required:!0}),Object(D.jsx)("label",{className:"text-input__label",children:c}),p&&Object(D.jsx)("span",{className:"text-input__password-button",onClick:function(){m(!f)},children:f?"Hide":"Show"})]})}),Z=(n(144),function(e){var t=e.isActive,n=e.setActive,c="switch ".concat(t&&"switch--active");return Object(D.jsx)("span",{className:c,onClick:function(){return n(!t)},children:Object(D.jsx)("span",{})})}),K=function(){var e=Object(a.useContext)(ne),t=Object(a.useContext)(ce),n=t.mail,r=t.setMail,i=t.organization,s=t.setOrganization,o=t.password,u=t.setPassword,l=Object(a.useState)(!0),d=Object(_.a)(l,2),b=d[0],j=d[1],f=function(){return Boolean(n&&i&&o)},m=function(){var e=Object(N.b)({enter:"animate__animated animate__slideInDown animate__faster",exit:"animate__animated animate__slideOutUp animate__faster"});N.c.error("All fields are required.",{hideProgressBar:!0,autoClose:1500,closeButton:!1,transition:e,draggable:!1,className:"custom-toast"}),N.c.clearWaitingQueue()},p=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n,c,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:t=e.sent,n=t.userName,c=t.url,a=t.password,r(n),s(c),u(a);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=Object(a.useCallback)((function(e){j(e)}),[]),v=V(),O=Object(a.useMemo)((function(){return W()&&v===c.Landscape}),[v]),x=Object(a.useMemo)((function(){return O?Object(D.jsx)("p",{className:"login-screen__p",children:"Enter the credentials you received via email"}):Object(D.jsxs)("p",{className:"login-screen__p",children:["Enter the credentials you ",Object(D.jsx)("br",{}),"received via email"]})}),[O]);return Object(D.jsxs)("div",{className:"login-screen",children:[Object(D.jsxs)("div",{className:"login-screen__navbar",children:[Object(D.jsx)("i",{className:"login-screen__icon login-screen__icon-back",onClick:function(){e("welcome-screen")},children:Object(D.jsx)(R.a,{src:Y})}),Object(D.jsx)("h1",{className:"login-screen__h1",children:"Login with email"}),Object(D.jsx)("i",{className:"login-screen__icon login-screen__icon-qr",onClick:p,children:Object(D.jsx)(R.a,{src:Q})})]}),x,Object(D.jsx)("div",{className:"login-screen__form-container".concat(O&&"--tablet","-flex"),children:Object(D.jsxs)("div",{className:"login-screen__form-container".concat(O&&"--tablet"),children:[Object(D.jsxs)("div",{className:"login-screen__inputs-container",children:[Object(D.jsx)(J,{value:i,onChange:s,label:"Organization",theme:"dark"}),Object(D.jsx)(J,{value:n,onChange:r,label:"Your email",type:"mail",theme:"dark"}),Object(D.jsx)(J,{value:o,onChange:u,label:"Password",type:"password",theme:"dark"})]}),Object(D.jsxs)("div",{className:"login-screen__save-password",children:[Object(D.jsx)("p",{children:"Save password"}),Object(D.jsx)(Z,{isActive:b,setActive:h})]}),Object(D.jsx)(G,{onPress:function(){var e;f()?(e={userName:n,url:i,password:o,savePassword:b},M.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.Controllers.HomeForm","SetupLoginAndSync",[0,F(e.url),e.userName,e.password,e.savePassword])):m()},children:"Login"})]})})]})},$=[],ee=function(e,t){var n={context:e,invoke:t},c=$.find((function(t){return t.context===e}));if(c){var a=$.indexOf(c);$.splice(a)}$.push(n)},te=["welcome-screen","login-screen"],ne=Object(a.createContext)(void 0),ce=Object(a.createContext)(void 0),ae=function(){var e=Object(a.useState)("welcome-screen"),t=Object(_.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(""),i=Object(_.a)(r,2),s=i[0],o=i[1],u=Object(a.useState)(""),l=Object(_.a)(u,2),d=l[0],b=l[1],j=Object(a.useState)(""),f=Object(_.a)(j,2),m=f[0],p=f[1];Object(a.useEffect)((function(){ee("login-navigator",h)}),[n]);var h=function(){"login-screen"===n&&v("welcome-screen")},v=Object(a.useCallback)((function(e){c(e)}),[]),O=Object(a.useMemo)((function(){return te.indexOf(n)}),[n]);return Object(D.jsx)(ne.Provider,{value:v,children:Object(D.jsx)(ce.Provider,{value:{mail:s,setMail:o,organization:d,setOrganization:b,password:m,setPassword:p},children:Object(D.jsxs)(B.a,{index:O,className:"login-navigator",disabled:!0,children:[Object(D.jsx)(X,{}),Object(D.jsx)(K,{})]})})})},re=(n(145),n(58)),ie=(n(147),n(97)),se=n(32),oe=n(33),ue=window.MobileCRM;!function(e){e[e.contains=0]="contains",e[e.startsWith=1]="startsWith"}(H||(H={}));var le=function(){function e(t,n,c,a,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:H.startsWith;Object(se.a)(this,e),this.currentPage=void 0,this.entityName=void 0,this.pageSize=void 0,this.searchFields=void 0,this.filter=void 0,this.attributes=void 0,this.nToN=void 0,this.filterType=void 0,this.entityName=t,this.attributes=n,this.currentPage=1,this.pageSize=c,this.searchFields=a,this.nToN=r,this.filterType=i}return Object(oe.a)(e,[{key:"getNextPage",value:function(){var e=this;return new Promise((function(t,n){var c=new ue.FetchXml.Entity(e.entityName);if(e.nToN){c.addLink(e.nToN.nToNEntityName,e.nToN.nToNfield,e.nToN.nToNIDField,"inner");var a=new ue.FetchXml.Filter;a.where(e.nToN.linkFilter,"eq",e.nToN.targetId),c.linkentities[0].filter=a}var r,i=Object(S.a)(e.attributes);try{for(i.s();!(r=i.n()).done;){var s=r.value;c.addAttribute(s)}}catch(u){i.e(u)}finally{i.f()}e.filter&&(c.filter=e.filter);var o=new ue.FetchXml.Fetch(c);o.count=e.pageSize,o.page=e.currentPage,T((function(){o.execute("DynamicEntities",(function(n){e.currentPage++;var c=e.parseEntities(n);t(c)}),(function(e){n(e)}))}))}))}},{key:"parseEntities",value:function(e){var t=e.map((function(e){return e.properties}));return t.map((function(t){var n;return t.entityName=null===(n=e[0])||void 0===n?void 0:n.entityName})),t.map((function(e){e._privVals;return Object(ie.a)(e,["_privVals"])}))}},{key:"setFilter",value:function(e){if(this.currentPage=1,this.searchFields)if(e){this.filter=new ue.FetchXml.Filter,this.filter.type="or";var t,n=Object(S.a)(this.searchFields);try{for(n.s();!(t=n.n()).done;){var c=t.value,a=new ue.FetchXml.Filter;switch(this.filterType){case H.contains:a.contains(c,e);break;case H.startsWith:a.startsWith(c,e)}this.filter.filters.push(a)}}catch(r){n.e(r)}finally{n.f()}}else this.filter=void 0}}]),e}(),de=n(95),be=n(94),je=function(e){Object(de.a)(n,e);var t=Object(be.a)(n);function n(){return Object(se.a)(this,n),t.apply(this,arguments)}return Object(oe.a)(n,null,[{key:"getInstance",value:function(){return this.instance||(this.instance=new n),this.instance}}]),n}(n(229).a);je.instance=void 0;var fe=je,me=(n(158),n.p+"static/media/profile.00b04659.svg"),pe=window.MobileCRM,he=function(){var e=Object(w.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T((function(){return new Promise((function(e,t){pe.Configuration.requestObject((function(t){Object(w.a)(g.a.mark((function n(){var c,a;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=t.settings.systemUserId,n.next=3,pe.DynamicEntity.loadAsync("systemuser",c);case 3:a=n.sent,e({name:a.properties.name,position:a.properties.rh_position,id:a.properties.id});case 5:case"end":return n.stop()}}),n)})))()}),(function(e){t(e)}))}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=(n(159),window.MobileCRM),Oe=function(e,t){return new Promise((function(n,c){var a=new ve.FetchXml.Entity("annotation");a.addAttributes();var r=new ve.FetchXml.Filter;r.type="and";var i=new ve.FetchXml.Filter;i.startsWith("subject",t),r.filters.push(i);var s=new ve.FetchXml.Filter;s.where("objectid","eq",e),r.filters.push(s),a.filter=r;var o=new ve.FetchXml.Fetch(a);T((function(){o.execute("DynamicEntities",(function(e){e.length>0?ve.DynamicEntity.loadDocumentBodyAsync("annotation",e[0].properties.id).then((function(e){n(e)})).catch((function(e){c(e)})):n("")}),(function(e){c(e)}))}))}))},xe=(n(160),function(){return Object(D.jsxs)("div",{className:"loading-wheel",children:[Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{}),Object(D.jsx)("div",{})]})}),ge=n(223),we=function(e){var t=e.fetchMethod,n=e.annotationId,c=e.annotationName,r=e.isThumbnail,i=e.placeholderIcon,s=e.hasFullscreenMode,u=e.onImageLoad,l=e.style,d=Object(o.b)(),b=Object(o.c)((function(e){return e.imagesToSave})),f=Object(a.useState)({state:"loading",value:""}),m=Object(_.a)(f,2),p=m[0],h=m[1];Object(a.useEffect)((function(){"byIdAndName"===t?O():"byUniqueName"===t?x():"byUniqueNameFromStore"===t&&v()}),[c,n]);var v=function(){var e=b.find((function(e){return e.imageUniqueName===c}));e&&h({state:"image",value:e.url})},O=function(){var e=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&c){e.next=3;break}return N(),e.abrupt("return");case 3:return e.prev=3,e.next=6,Oe(n,c);case 6:(t=e.sent).length?k(t):N(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),N();case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=3;break}return N(),e.abrupt("return");case 3:if(t=new fe,e.prev=4,!r){e.next=11;break}return e.next=8,t.loadImageThumbByImageUniqueName(c);case 8:n=e.sent,e.next=14;break;case 11:return e.next=13,t.loadImageByUniqueName(c);case 13:n=e.sent;case 14:(a=n.srcB64).length?k(a):N(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),N();case 21:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(){return e.apply(this,arguments)}}(),N=function(){h({state:"placeholder",value:""})},k=function(e){var t="data:image/png;base64, ".concat(e);h({state:"image",value:t})};return Object(D.jsxs)("div",{className:"annotation-image",onClick:function(){s&&!(null===c||void 0===c?void 0:c.endsWith(ge.d))&&d(j({fetchMethod:t,annotationName:c||"",annotationId:n||""}))},children:["loading"===p.state&&Object(D.jsx)(xe,{}),"placeholder"===p.state&&i&&Object(D.jsx)(R.a,{className:"annotation-image__placeholder",src:i}),"image"===p.state&&Object(D.jsx)("img",{style:l,alt:"Annotation",onLoadCapture:function(){u&&u()},src:p.value}),s&&Object(D.jsx)("i",{className:"annotation-image__icon-fullscreen"})]})},_e=window.MobileCRM,Ne=0,ke=Object(a.forwardRef)((function(e,t){var n=e.children,r=e.headerElement,i=e.extraIconElement,s=e.onScrollEnd,u=(e.onProfileClickCallback,Object(a.useContext)(xn)),b=Object(o.b)(),j=Object(a.useState)(""),f=Object(_.a)(j,2),m=f[0],p=f[1],h=Object(a.useState)(1),v=Object(_.a)(h,2),O=v[0],x=v[1],N="navbar-scroll ".concat(1===O?"navbar-scroll--uncollapsed":"");Object(a.useEffect)((function(){k()}),[]);var k=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he();case 2:t=e.sent,n=t.id,p(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=V(),y=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n,c,a,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P({ScannerTitle:"Scan QR",ScannerDescription:"Place the QR code inside the area. Scanning will start automatically.",IsSquareShown:!0});case 2:t=e.sent,n=S(t),c=Object(_.a)(n,3),a=c[1],r=c[2],"fs_asset"===a?E(r):"rh_guide"===a&&q(r);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(e){var t=e.split(";"),n=Object(_.a)(t,3);return[n[0],n[1],n[2]]},M=function(){var e=Object(w.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){_e.Platform.getNetworkInfo(e,t)}));case 2:if(!e.sent.connected){e.next=12;break}return(n=new MobileCRM.UI.MessageBox("".concat(t," not found. Synchronize your mobile app with the server?"),"No")).items.push("Sync now"),e.next=8,n.showAsync();case 8:"Sync now"===e.sent&&I(),e.next=13;break;case 12:MobileCRM.bridge.alert("".concat(t," not found. Syncing the app might help."));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(w.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.prev=1,e.next=4,n.loadEquipmentById(t);case 4:c=e.sent,b(l(c)),e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(1),e.next=12,M("Equipment");case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(w.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.prev=1,e.next=4,n.loadGuideById(t);case 4:c=e.sent,b(d(c)),e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(1),e.next=12,M("Guide");case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),T=Object(a.useState)(!1),U=Object(_.a)(T,2),F=U[0],L=U[1];return Object(a.useEffect)((function(){L(C===c.Landscape&&W())}),[C]),Object(D.jsxs)("div",{className:N,children:[Object(D.jsx)("header",{ref:t,className:"navbar ".concat(F&&"tablet"),children:Object(D.jsxs)("section",{className:"navbar__flexbox",children:[Object(D.jsxs)("div",{className:"navbar__group",children:[Object(D.jsx)("i",{className:"navbar__icon navbar__icon-profile",onClick:function(){u("profile-screen")},"data-test":"ProfileIcon",children:Object(D.jsx)("i",{className:"navbar__icon-wrapper",children:Object(D.jsx)(we,{fetchMethod:"byIdAndName",annotationId:m,annotationName:"UserImage",isThumbnail:!0,placeholderIcon:me,hasFullscreenMode:!1})})}),Object(D.jsx)("h1",{className:"navbar__h1",children:r})]}),i,Object(D.jsx)("i",{className:"navbar__icon navbar__icon-qr",onClick:y,"data-test":"ScanBarcodeButton",children:Object(D.jsx)(R.a,{src:Q})})]})}),Object(D.jsx)("main",{className:"scroll-view ".concat(F&&"tablet"),onScroll:function(e){var t=e.target,n=t.scrollTop>0?t.scrollTop:0,c=t.offsetHeight,a=t.scrollHeight;Math.abs(c+n-a)<100&&s(),n-Ne>100?(x(-1),Ne=n):Ne-n>100&&(x(1),Ne=n)},children:n})]})})),Ce=n(14),ye=n(13),Ie=(n(161),n.p+"static/media/search.f50f0d7b.svg"),Se=n.p+"static/media/List-2.522a59e0.svg",Pe=n.p+"static/media/List-3.d3d3a384.svg",Me=0,Ee=Object(a.forwardRef)((function(e,t){var n=e.DataSource,c=e.ListItem,r=e.searchPlaceholder,i=e.onItemClick,s=e.small,o=e.GridItem,u=Object(a.useState)([]),l=Object(_.a)(u,2),d=l[0],b=l[1],j=Object(a.useState)(!1),f=Object(_.a)(j,2),m=f[0],p=f[1];Object(a.useImperativeHandle)(t,(function(){return{loadNextEntities:v}})),Object(a.useEffect)((function(){h()}),[n]),Object(a.useEffect)((function(){Me>0&&d.length<10&&v()}),[d]);var h=function(){v(!0)},v=function(){var e=Object(w.a)(g.a.mark((function e(t,c){var a,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getNextPage();case 2:if(a=e.sent,!t||a.length){e.next=6;break}return b([]),e.abrupt("return");case 6:return Me=a.length,e.next=9,O(a);case 9:r=e.sent,b(t?r:[].concat(Object(ye.a)(d),Object(ye.a)(r)));case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(w.a)(g.a.mark((function e(t){var n,c,a,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("systemuser"!==(null===(n=t[0])||void 0===n?void 0:n.entityName)){e.next=8;break}return e.next=3,he();case 3:return a=e.sent,r=t.filter((function(e){return e.id!==a.id})),e.abrupt("return",r);case 8:if("rh_guide"!==(null===(c=t[0])||void 0===c?void 0:c.entityName)){e.next=11;break}return i=t.filter((function(e){return 473220002===e.statuscode||"published"===e.statusReason})),e.abrupt("return",i);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=Object(a.useMemo)((function(){return Object(D.jsx)(D.Fragment,{children:d.length?d.map((function(e,t){var n=e.id;return o&&m?Object(D.jsx)(o,Object(Ce.a)(Object(Ce.a)({id:n,onClick:i},e),{},{small:s}),n||t):Object(D.jsx)(c,Object(Ce.a)(Object(Ce.a)({id:n,onClick:i},e),{},{small:s}),n||t)})):Object(D.jsx)("span",{className:"list-view__items-placeholder",children:"No items found"})})}),[d,s,m]),N=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t){var c,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.target.value,n.setFilter(c),e.next=4,n.getNextPage();case 4:a=e.sent,b(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n]);return Object(D.jsxs)("div",{className:"list-view",children:[Object(D.jsxs)("div",{className:"list-view__search-box",children:[Object(D.jsx)("i",{className:"list-view__icon-search",children:Object(D.jsx)(R.a,{src:Ie})}),Object(D.jsx)("input",{type:"text",className:"list-view__search-input",placeholder:r,onInput:N,"data-test":"SearchBar"}),W()&&o&&Object(D.jsx)("i",{className:"list-view__icon-grid-switch",onClick:function(){p(!m)},children:Object(D.jsx)(R.a,{src:m?Pe:Se})})]}),Object(D.jsx)("div",{className:"list-view__".concat(m?"grid":"list"),children:x})]})})),qe=(n(162),n.p+"static/media/cpu.992cfbfc.svg"),Te=n.p+"static/media/arrow-right.2ded7106.svg",Ue=function(e){var t=e.name,n=e.serialnumber,c=e.id,a=e.onClick;return Object(D.jsxs)("div",{className:"equipment-list-item",onClick:function(){return a(c)},children:[Object(D.jsx)("i",{className:"equipment-list-item__image",children:Object(D.jsx)(we,{fetchMethod:"byIdAndName",annotationId:c,annotationName:"EquipmentImage",isThumbnail:!0,placeholderIcon:qe,hasFullscreenMode:!1})}),Object(D.jsxs)("div",{className:"equipment-list-item__info",children:[Object(D.jsx)("h3",{className:"equipment-list-item__name",children:t}),Object(D.jsx)("h4",{className:"equipment-list-item__serialnumber",children:n})]}),Object(D.jsx)("i",{className:"equipment-list-item__icon-next",children:Object(D.jsx)(R.a,{src:Te})})]})},Fe=(n(163),function(e){var t=e.name,n=e.serialnumber,c=e.id,a=e.onClick,r=e.small;return Object(D.jsx)("div",{className:"equipment-grid-item__wrapper ".concat(r&&"small"),children:Object(D.jsxs)("div",{className:"equipment-grid-item",onClick:function(){return a(c)},children:[Object(D.jsx)("i",{className:"equipment-grid-item__image",children:Object(D.jsx)(we,{fetchMethod:"byIdAndName",annotationId:c,annotationName:"EquipmentImage",isThumbnail:!0,placeholderIcon:qe,hasFullscreenMode:!1})}),Object(D.jsx)("div",{className:"equipment-grid-item__info-wrapper",children:Object(D.jsxs)("div",{className:"equipment-grid-item__info",children:[Object(D.jsx)("h4",{className:"equipment-grid-item__serialnumber",children:n}),Object(D.jsx)("h3",{className:"equipment-grid-item__name",children:t})]})})]})})}),Le=n(59),Be=function(e){var t=e.onProfileClickCallback,n=Object(a.useMemo)((function(){return new le("fs_asset",["name","serialnumber","id","rh_installedby","rh_identifier","rh_description"],10,["name"],null,H.contains)}),[]),c=Object(o.b)(),r=Object(a.useRef)(),i=Object(a.useCallback)((function(){r.current&&r.current.loadNextEntities()}),[r]),s=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t){var n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.next=3,n.loadEquipmentById(t);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:c(l(a));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),u=Object(Le.a)(),d=u.width,b=u.ref,j=Object(a.useState)(!1),f=Object(_.a)(j,2),m=f[0],p=f[1];return Object(a.useEffect)((function(){p(!!(d&&d<700))}),[d]),Object(D.jsx)(ke,{headerElement:Object(D.jsx)(D.Fragment,{children:"Equipment"}),onScrollEnd:i,onProfileClickCallback:t,ref:b,children:Object(D.jsx)(Ee,{DataSource:n,ListItem:Ue,GridItem:Fe,ref:r,onItemClick:s,searchPlaceholder:"Find a product",small:m})})},Re=r.a.memo(Be),Ae=(n(164),n.p+"static/media/plus.c2c2df71.svg"),De=(n(165),n.p+"static/media/guide.32b02986.svg"),Ge=window.MobileCRM,He=function(){var e=Object(w.a)(g.a.mark((function e(t,n,c){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(Object(w.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ge.DynamicEntity.loadAsync(n,t);case 2:return e.t0=c,e.abrupt("return",e.sent.properties[e.t0]);case 4:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),We=function(e){var t,n=e.rh_name,c=e.rh_annotationsubject,r=(e.id,e.rh_guideid),i=e.onClick,s=Object(a.useState)(null),o=Object(_.a)(s,2),u=o[0],l=o[1],d=(null===u||void 0===u||null===(t=u.steps)||void 0===t?void 0:t.length)||0;Object(a.useEffect)((function(){b()}),[r]);var b=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return t=new fe,e.next=5,t.loadGuideById(r);case 5:return n=e.sent,e.prev=6,e.next=9,He(n.categoryId||"","rh_guidecategory","rh_name");case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0="";case 12:c=e.t0,l(Object(Ce.a)(Object(Ce.a)({},n),{},{guideCategory:c||""})),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(6),l(Object(Ce.a)(Object(Ce.a)({},n),{},{guideCategory:""}));case 19:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{className:"guide-list-item",onClick:function(){return i(r||"")},children:[Object(D.jsx)("i",{className:"guide-list-item__image",children:Object(D.jsx)(we,{fetchMethod:"byUniqueName",annotationName:c,isThumbnail:!0,placeholderIcon:De,hasFullscreenMode:!1})}),Object(D.jsxs)("div",{className:"guide-list-item__info",children:[Object(D.jsx)("h4",{className:"guide-list-item__type",children:null===u||void 0===u?void 0:u.guideCategory}),Object(D.jsx)("h3",{className:"guide-list-item__name",children:n}),Object(D.jsx)("span",{className:"guide-list-item__steps",children:"".concat(d||"0"," ").concat(d>1?"Steps":"Step")})]}),Object(D.jsx)("i",{className:"guide-list-item__icon-next"})]})},ze=(n(166),n.p+"static/media/up-down.bad9cb20.svg"),Ve=function(e){var t=e.header,n=e.items,c=e.selectedItem,a=e.setSelectedItem,r=function(e){return n.find((function(t){return t.name===e}))||null};return Object(D.jsxs)("div",{className:"navbar-select",children:[Object(D.jsx)("h2",{className:"navbar-select__header",children:t}),Object(D.jsxs)("select",{onChange:function(e){var t=e.target.value;if("All"!==t){var n=r(t);n&&a(n)}else a("All")},children:[Object(D.jsx)("option",{value:"All",children:"All"}),n.map((function(e){return Object(D.jsx)("option",{value:e.name,children:e.name})}))]}),Object(D.jsxs)("span",{className:"navbar-select-wrapper",children:[Object(D.jsx)("div",{className:"navbar-select__group",children:"All"===c||"string"===typeof c?c:c.name}),Object(D.jsx)("i",{className:"navbar-select__icon-up-down",children:Object(D.jsx)(R.a,{src:ze})})]})]})},Xe=function(e){var t=e.onProfileClickCallback,n=e.onPlusClickCallback,r=Object(a.useState)([]),i=Object(_.a)(r,2),s=i[0],u=i[1],l=Object(a.useState)("All"),b=Object(_.a)(l,2),j=b[0],f=b[1],m=Object(a.useContext)(dn),p=Object(o.b)(),h=Object(a.useRef)(),v=Object(a.useMemo)((function(){return new le("rh_guide",["rh_guideid","rh_name","rh_annotationsubject","statuscode"],10,["rh_name"],"All"===j?null:{nToNEntityName:"rh_guidecategory",nToNfield:"rh_guidecategoryid",nToNIDField:"rh_guidecategoryid",targetId:j.id,linkFilter:"rh_guidecategoryid"},H.contains)}),[j]);Object(a.useEffect)((function(){O()}),[]);var O=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new fe,e.next=3,t.loadAllCategories();case 3:n=e.sent,u(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=Object(a.useCallback)((function(){h.current&&h.current.loadNextEntities()}),[]),N=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.next=3,n.loadGuideById(t);case 3:if(c=e.sent){e.next=6;break}return e.abrupt("return");case 6:p(d(c));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),k=V();return Object(D.jsx)(ke,{headerElement:Object(D.jsx)(Ve,{header:"Library",items:s,selectedItem:j,setSelectedItem:f}),extraIconElement:Object(D.jsx)("i",{className:"navbar__icon navbar__icon-plus",onClick:function(){W()&&k===c.Landscape?n():m("fullscreen-modal-toggle")},"data-test":"AddNewButton",children:Object(D.jsx)(R.a,{src:Ae})}),onScrollEnd:x,onProfileClickCallback:t,children:Object(D.jsx)(Ee,{DataSource:v,ListItem:We,ref:h,onItemClick:N,searchPlaceholder:"Find a guide"})})},Ye=(n(167),n.p+"static/media/call.b40e1a4b.svg"),Qe=function(e){var t=e.rh_position,n=e.name,c=e.id,a=e.onClick;return Object(D.jsxs)("div",{className:"user-list-item",onClick:function(){return a(c,n)},children:[Object(D.jsx)("i",{className:"user-list-item__profile-image",children:Object(D.jsx)(we,{fetchMethod:"byIdAndName",annotationId:c,annotationName:"UserImage",isThumbnail:!0,placeholderIcon:me,hasFullscreenMode:!1})}),Object(D.jsx)("h3",{className:"user-list-item__name",children:n}),Object(D.jsx)("div",{className:"user-list-item__state-container",children:t&&Object(D.jsx)("span",{className:"user-list-item__state",children:t})}),Object(D.jsx)("i",{className:"user-list-item__icon-call","data-test":"CallButton",children:Object(D.jsx)(R.a,{src:Ye})})]})},Je=window.MobileCRM,Ze=function(e,t){Je.bridge.invokeMethodAsync("HomeForm","InitiateHoustonCall",[new Je.Reference("systemuser",e,t),!1])},Ke=function(){var e=Object(w.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,$e(n);case 4:e.sent&&Ze(t,n);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$e=function(){var e=Object(w.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new MobileCRM.UI.MessageBox("Call ".concat(t,"?"))).items=["Yes","No"],e.next=4,n.showAsync();case 4:if("Yes"!==e.sent){e.next=7;break}return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),et=Ke,tt=function(e){var t=e.onProfileClickCallback,n=Object(a.useMemo)((function(){return new le("systemuser",["name","rh_position","id"],10,["name","lastname","firstname"],{nToNEntityName:"systemuser_role",nToNfield:"systemuserid",nToNIDField:"id",targetId:"a32f9ad4-3952-4600-8fa3-594b1587acd6",linkFilter:"roleid"})}),[]),c=Object(a.useRef)(),r=Object(a.useCallback)((function(){c.current&&c.current.loadNextEntities()}),[c]),i=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:et(t,n||"Unknown user");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]);return Object(D.jsx)(ke,{headerElement:Object(D.jsx)(D.Fragment,{children:"Experts"}),onScrollEnd:r,onProfileClickCallback:t,children:Object(D.jsx)(Ee,{DataSource:n,ListItem:Qe,ref:c,onItemClick:i,searchPlaceholder:"Find an expert"})})},nt=r.a.memo(tt),ct=(n(168),n.p+"static/media/page.53e27269.svg"),at=function(e){var t=e.view,n=e.navigateTabBar,c=e.useTabletUI,a="tabbar__swiper tabbar__swiper--pos-".concat(t),r="tabbar__icon ".concat(c&&"tablet"," ").concat(0===t&&"tabbar__icon--selected"),i="tabbar__icon ".concat(c&&"tablet"," ").concat(1===t&&"tabbar__icon--selected"),s="tabbar__icon ".concat(c&&"tablet"," ").concat(2===t&&"tabbar__icon--selected");return Object(D.jsxs)("div",{className:"tabbar ".concat(c&&"tablet"),children:[c||Object(D.jsx)("div",{className:a}),Object(D.jsx)("i",{className:r,onClick:function(){n("equipment-list")},"data-test":"Equipment-Button",children:Object(D.jsx)(R.a,{src:qe})}),Object(D.jsx)("i",{className:i,onClick:function(){n("library-screen")},"data-test":"Libary-button",children:Object(D.jsx)(R.a,{src:ct})}),Object(D.jsx)("i",{className:s,onClick:function(){n("calls-list")},"data-test":"Experts-button",children:Object(D.jsx)(R.a,{src:Ye})})]})},rt=(n(169),n(170),n.p+"static/media/arrow.75ea426f.svg"),it=function(e){var t=e.onEquipmentSet,n=e.onBackClick,c=e.source,r=e.onModelClick,i=Object(a.useContext)(dn),s=Object(a.useContext)(ft),u=Object(o.b)(),b=Object(a.useState)(!1),j=Object(_.a)(b,2),f=j[0],m=j[1],p=Object(a.useState)(""),h=Object(_.a)(p,2),v=h[0],O=h[1],x=Object(a.useState)(""),N=Object(_.a)(x,2),k=N[0],C=N[1],y="product-view__navbar ".concat(f&&"product-view__navbar--full");Object(a.useEffect)((function(){S(),I(),t&&(null===c||void 0===c?void 0:c.id)&&t()}),[c]);var I=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he();case 2:t=e.sent,n=t.id,C(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===c||void 0===c?void 0:c.modelId){e.next=4;break}O(""),e.next=8;break;case 4:return e.next=6,He(null===c||void 0===c?void 0:c.modelId,"rh_model","rh_name");case 6:t=e.sent,O(t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=Object(a.useCallback)((function(e,t){et(e,t||"Unknown user")}),[]),M=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.next=3,n.loadGuideById(t);case 3:if(c=e.sent){e.next=6;break}return e.abrupt("return");case 6:u(d(c));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),E=Object(a.useMemo)((function(){var e;return(null===c||void 0===c||null===(e=c.guideList)||void 0===e?void 0:e.length)?Object(D.jsx)(D.Fragment,{children:null===c||void 0===c?void 0:c.guideList.map((function(e){var t=e.name,n=e.id,c=e.imageUniqueName;return Object(D.jsx)(We,{id:n,rh_guideid:n,rh_name:t,rh_annotationsubject:c,onClick:M},n)}))}):Object(D.jsx)(D.Fragment,{})}),[null===c||void 0===c?void 0:c.guideList]),q=Object(a.useMemo)((function(){var e,t=null===c||void 0===c||null===(e=c.users)||void 0===e?void 0:e.filter((function(e){return e.id!==k}));return(null===t||void 0===t?void 0:t.length)?Object(D.jsx)(D.Fragment,{children:null===t||void 0===t?void 0:t.map((function(e){return Object(D.jsx)(Qe,{id:e.id,name:e.name,rh_position:e.position,onClick:P},e.id)}))}):Object(D.jsx)(D.Fragment,{})}),[null===c||void 0===c?void 0:c.users,k]);return Object(D.jsxs)("div",{className:"product-view",onScroll:function(e){var t,n=null===(t=e.target.querySelector(".product-view__information"))||void 0===t?void 0:t.querySelector("h1"),c=(null===n||void 0===n?void 0:n.getBoundingClientRect().top)||100;c<40&&!f?m(!0):c>40&&f&&m(!1)},children:[Object(D.jsxs)("section",{children:[Object(D.jsxs)("nav",{className:y,children:[Object(D.jsx)("i",{className:"product-view__icon-back",onClick:function(){n&&n(),c.isModel||(i("tabbar-navigator"),setTimeout((function(){u(l(null))}),300))},children:Object(D.jsx)(R.a,{src:Y})}),Object(D.jsx)("h1",{children:(null===c||void 0===c?void 0:c.name)||"No name found"}),Object(D.jsx)("span",{})]}),Object(D.jsx)("div",{className:"product-view__image-container",children:Object(D.jsx)(we,{fetchMethod:"byIdAndName",annotationId:null===c||void 0===c?void 0:c.id,annotationName:(null===c||void 0===c?void 0:c.isModel)?"ModelImage":"EquipmentImage",isThumbnail:!1,placeholderIcon:qe,hasFullscreenMode:!0})})]}),Object(D.jsxs)("section",{className:"product-view__information",children:[v&&Object(D.jsxs)("h2",{style:{color:"#2699FB",display:"flex",alignItems:"center",alignContent:"center"},onClick:function(){r&&r((null===c||void 0===c?void 0:c.modelId)||"")},children:[v,Object(D.jsx)(R.a,{src:rt,style:{display:"flex",marginLeft:"6px"}})]}),Object(D.jsx)("h1",{children:(null===c||void 0===c?void 0:c.name)||"No name found"}),Object(D.jsx)("p",{children:(null===c||void 0===c?void 0:c.description)||"No desciption found"}),(null===c||void 0===c?void 0:c.serialNumber)&&Object(D.jsxs)("div",{children:[Object(D.jsx)("span",{children:"Serial number"}),Object(D.jsx)("b",{children:null===c||void 0===c?void 0:c.serialNumber})]}),(null===c||void 0===c?void 0:c.installedBy)&&Object(D.jsxs)("div",{children:[Object(D.jsx)("span",{children:"Installed By"}),Object(D.jsx)("b",{children:null===c||void 0===c?void 0:c.installedBy})]}),(null===c||void 0===c?void 0:c.inventoryIdentifier)&&Object(D.jsxs)("div",{children:[Object(D.jsx)("span",{children:"ID"}),Object(D.jsx)("b",{children:null===c||void 0===c?void 0:c.inventoryIdentifier})]})]}),Object(D.jsxs)("section",{className:"product-view__library",children:[Object(D.jsx)("h1",{children:"Library"}),Object(D.jsx)("h2",{children:"Guides"}),Object(D.jsx)("div",{children:E}),(null===c||void 0===c?void 0:c.moreGuides)&&Object(D.jsx)("div",{className:"product-view__show-more",onClick:function(){s("guides-list")},children:"Show more"}),Object(D.jsx)("h1",{children:"Experts"}),Object(D.jsx)("div",{children:q})]})]})},st=r.a.memo(it),ot=(n(171),function(e){var t=e.listSource,n=e.caption,c=Object(a.useContext)(ft),r=Object(a.useRef)(),i=Object(o.c)((function(e){return null===e||void 0===e?void 0:e.selectedEquipment})),s=Object(o.b)(),u=Object(a.useState)(null),l=Object(_.a)(u,2),b=l[0],j=l[1];Object(a.useEffect)((function(){j(i?t:null)}),[i]);var f=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.next=3,n.loadGuideById(t);case 3:if(c=e.sent){e.next=6;break}return e.abrupt("return");case 6:s(d(c));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(D.jsxs)("div",{className:"guides-list",children:[Object(D.jsxs)("nav",{className:"guides-list__navbar",children:[Object(D.jsx)("i",{className:"guides-list__icon-back",onClick:function(){c("equipment-detail")},children:Object(D.jsx)(R.a,{src:Y})}),Object(D.jsxs)("h1",{children:["Guides for ",n||(null===i||void 0===i?void 0:i.name)]})]}),b&&Object(D.jsx)(Ee,{DataSource:b,ListItem:We,ref:r,onItemClick:f,searchPlaceholder:"Find a guide"})]})}),ut=r.a.memo(ot),lt=n(231),dt=(n(172),function(e){var t=e.children,n=e.onCancelClick,c=e.contentHeightPercentage,a=e.closeButtonText,r=e.roundedCorner,i=e.contentWidthPercentage,s={height:"".concat(c,"vh"),width:"".concat(i,"vw"),overflow:"scroll"};return r&&(s.borderRadius="10px 10px 0 0"),Object(D.jsxs)("div",{className:"modalContentWrapper",style:s,children:[a&&Object(D.jsx)("div",{className:"modalContentWrapper__button-wrapper",children:Object(D.jsx)("div",{className:"modalContentWrapper__button",onClick:n,children:a})}),Object(D.jsx)("div",{className:"child-wrapper",children:t})]})}),bt=function(){function e(t,n){Object(se.a)(this,e),this.modelId=void 0,this.houstonService=void 0,this.searchText=void 0,this.loaded=!1,this.type="equipment",this.modelId=t,this.houstonService=new fe,n&&(this.type=n)}return Object(oe.a)(e,[{key:"getNextPage",value:function(){var e=Object(w.a)(g.a.mark((function e(){var t=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(Object(w.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loaded){e.next=2;break}return e.abrupt("return",[]);case 2:if(n="model"===t.type?t.houstonService.loadModelGuideList:t.houstonService.loadEquipmentGuideList,t.loaded=!0,!t.searchText){e.next=8;break}return e.next=7,n(t.modelId);case 7:return e.abrupt("return",e.sent.filter((function(e){return e.name.includes(t.searchText||"")})).map((function(e){return Object(Ce.a)({rh_name:e.name,rh_annotationsubject:e.imageUniqueName,rh_guideid:e.id,entityName:"rh_guide"},e)})));case 8:return e.next=10,n(t.modelId);case 10:return e.abrupt("return",e.sent.map((function(e){return Object(Ce.a)({rh_name:e.name,rh_annotationsubject:e.imageUniqueName,rh_guideid:e.id,entityName:"rh_guide"},e)})));case 11:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setFilter",value:function(e){this.searchText=e,this.loaded=!1}}]),e}(),jt=["equipment-detail","guides-list"],ft=Object(a.createContext)(void 0),mt=function(e){var t=e.onEquipmentSet,n=e.onBackClick,r=Object(a.useState)("equipment-detail"),i=Object(_.a)(r,2),s=i[0],u=i[1],l=Object(a.useContext)(dn),d=Object(a.useState)({moreUsers:!1,moreGuides:!1}),b=Object(_.a)(d,2),j=b[0],f=b[1],m=Object(a.useState)({moreUsers:!1,moreGuides:!1}),p=Object(_.a)(m,2),h=p[0],v=p[1],O=Object(o.c)((function(e){return e.selectedEquipment})),x=Object(o.c)((function(e){return e.selectedGuide})),N=Object(a.useState)(),k=Object(_.a)(N,2),C=k[0],y=k[1];Object(a.useEffect)((function(){O&&f({id:O.id,name:O.name,installedBy:O.installedBy,inventoryIdentifier:O.inventoryIdentifier,description:O.description,serialNumber:O.serialNumber,modelId:O.modelId,users:O.experts,guideList:O.guideList,moreGuides:O.moreGuides,moreUsers:!0})}),[O]),Object(a.useEffect)((function(){C&&(v({id:C.id,name:C.name,description:C.description,users:C.experts,guideList:C.guideList,moreUsers:!1,moreGuides:C.moreGuides,isModel:!0}),G(!0))}),[C]);var I=Object(a.useCallback)((function(e){u(e)}),[]),S=V(),P=Object(a.useState)(!1),M=Object(_.a)(P,2),E=M[0],q=M[1];Object(a.useEffect)((function(){q(S===c.Landscape&&W())}),[S]),Object(a.useEffect)((function(){ee("equipment-navigator",T)}),[s,O,x]);var T=function(){"equipment-detail"===s&&O&&l("tabbar-navigator"),"guides-list"!==s||x||I("equipment-detail")},U=Object(a.useMemo)((function(){return jt.indexOf(s)}),[s]),F=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new fe,e.prev=1,e.next=4,n.loadModelById(t);case 4:c=e.sent,y(c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),MobileCRM.bridge.alert(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),[O]),L=Object(a.useState)(!1),R=Object(_.a)(L,2),A=R[0],G=R[1],H=Object(a.useMemo)((function(){if(null===O||void 0===O?void 0:O.id)return new bt(O.id)}),[O]),z=Object(a.useMemo)((function(){if(null===C||void 0===C?void 0:C.id)return new bt(C.id,"model")}),[C]);return Object(D.jsxs)(ft.Provider,{value:I,children:[Object(D.jsxs)(B.a,{index:U,className:"equipment-navigator".concat(E?"__tablet":""),disabled:!0,children:[Object(D.jsx)(st,{onModelClick:F,source:j,onEquipmentSet:t,onBackClick:n}),H&&Object(D.jsx)(ut,{listSource:H})]}),Object(D.jsx)(lt.a,{anchor:"right",open:A,PaperProps:{style:{backgroundColor:"transparent",alignItems:"center"}},children:Object(D.jsx)(dt,{contentWidthPercentage:E?40:100,contentHeightPercentage:100,children:Object(D.jsxs)(B.a,{index:U,className:"equipment-navigator".concat(E?"__tablet":""),disabled:!0,children:[Object(D.jsx)(st,{onBackClick:function(){return G(!1)},source:h,onEquipmentSet:t}),z&&Object(D.jsx)(ut,{caption:null===h||void 0===h?void 0:h.name,listSource:z})]})})})]})},pt=(n(173),function(e){var t=e.onProfileClick,n=Object(a.useState)(!1),c=Object(_.a)(n,2),r=c[0],i=c[1],s=Object(a.useCallback)((function(){i(!0)}),[]),o=Object(a.useCallback)((function(){i(!1)}),[]);return Object(D.jsx)(re.a,{sidebar:Object(D.jsx)(mt,{onBackClick:o,onEquipmentSet:s}),pullRight:!0,docked:r,touch:!1,sidebarClassName:"sidebar-content",children:Object(D.jsx)(Re,{onProfileClickCallback:t})})}),ht=n(96),vt=(n(174),{title:"",equipment:null,description:"",category:null,coverPhoto:"",steps:[{id:1,title:"",photo:"",description:"",imageUniqueName:""}]}),Ot=function(e,t){var n=t.key,c=t.payload;switch(n){case"title":return void(e.title=c.newValue);case"equipment":return void(e.equipment=c.newValue);case"description":return void(e.description=c.newValue);case"category":return void(e.category=c.newValue);case"coverPhoto":return void(e.coverPhoto=c.newValue);case"steps":return void(e.steps=c.newValue);case"deleteAll":return void(e=vt);default:throw new Error("No reducer available for key: ".concat(n))}},xt=Object(a.createContext)({state:vt,handleChange:function(){}}),gt=function(){var e=Object(a.useContext)(xt);if(!e)throw new Error("useCollectFormContext must be used within a Context provider.");return e},wt=(n(175),n(176),n.p+"static/media/chevron-down.26a26bc6.svg"),_t=function(e){var t=e.items,n=e.selectedItem,c=e.setSelectedItem,a=e.label,r=function(e){return t.find((function(t){return t.name===e}))||null};return Object(D.jsxs)("div",{className:"field-select",children:[Object(D.jsx)("span",{className:"field-select__label",children:a}),Object(D.jsx)("h1",{className:"field-select__name",children:(null===n||void 0===n?void 0:n.name)||Object(D.jsx)("b",{children:"Select"})}),Object(D.jsxs)("select",{onChange:function(e){var t=e.target.value;if("None"!==t){var n=r(t);n&&c(n)}else c(null)},children:[Object(D.jsx)("option",{children:"None"}),t.map((function(e){return Object(D.jsx)("option",{value:e.name,children:e.name})}))]}),Object(D.jsx)("i",{className:"field-select__icon",children:Object(D.jsx)(R.a,{src:wt})})]})},Nt=function(){var e,t=gt(),n=t.state,c=t.handleChange,r=Object(o.c)((function(e){return[e.equipment,e.categories]})),i=Object(_.a)(r,2),s=i[0],u=i[1],l=Object(a.useContext)($t);return Object(D.jsxs)("div",{className:"collect-screen__content",children:[Object(D.jsxs)("div",{className:"collect-screen__form",children:[Object(D.jsx)(J,{value:n.title,onChange:function(e){return c("title",e)},label:"Title *",theme:"light",placeholder:"Add Title",startCapital:!0}),Object(D.jsx)(_t,{items:s,selectedItem:n.equipment,setSelectedItem:function(e){return c("equipment",e)},label:"Equipment"}),Object(D.jsx)(J,{value:n.description,onChange:function(e){return c("description",e)},label:"Description",theme:"light",placeholder:"Add description",startCapital:!0,multiline:!0}),Object(D.jsx)(_t,{items:u,selectedItem:n.category,setSelectedItem:function(e){return c("category",e)},label:"Category"})]}),Object(D.jsx)(G,{onPress:function(){l("step-2")},disabled:!(null===n||void 0===n||null===(e=n.title)||void 0===e?void 0:e.length),children:"Continue"})]})},kt=(n(177),n.p+"static/media/trash.7107d61e.svg"),Ct="2048x1536",yt=function(e){var t=e.base64,n=e.onChange,c=e.slim,a="photo-picker ".concat(c&&"photo-picker--slim"),r=function(){var e=Object(w.a)(g.a.mark((function e(){var t,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:if("camera"!==(t=e.sent)){e.next=10;break}return e.next=6,s();case 6:c=e.sent,n(c),e.next=15;break;case 10:if("gallery"!==t){e.next=15;break}return e.next=13,o();case 13:c=e.sent,n(c);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new MobileCRM.UI.MessageBox("Choose one")).items=["Open camera","Pick from gallery","Cancel"],e.next=4,t.showAsync();case 4:if("Open camera"!==(n=e.sent)){e.next=9;break}return e.abrupt("return","camera");case 9:if("Pick from gallery"!==n){e.next=11;break}return e.abrupt("return","gallery");case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(w.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n=new MobileCRM.Services.DocumentService;n.maxImageSize=Ct,n.capturePhoto((function(n){MobileCRM.Application.readFileAsBase64(n.filePath,(function(t){e(t)}),t)}),t)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=Object(w.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n=new MobileCRM.Services.DocumentService;n.maxImageSize=Ct,n.selectPhoto((function(n){MobileCRM.Application.readFileAsBase64(n.filePath,(function(t){e(t)}),t)}),t)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t?Object(D.jsxs)("div",{className:"photo-picker__image-container",children:[Object(D.jsx)("img",{src:"data:image/png;base64, ".concat(t),alt:""}),Object(D.jsx)("i",{className:"photo-picker__icon-delete",onClick:function(){n("")},children:Object(D.jsx)(R.a,{src:kt})})]}):Object(D.jsxs)("div",{className:a,onClick:r,children:[Object(D.jsx)("i",{className:"photo-picker__icon-plus",children:Object(D.jsx)(R.a,{src:Ae})}),"Add photo"]})},It=n(17),St=(n(178),n(44)),Pt=function(){var e=Object(w.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("data:".concat(t.mimeType,";base64, ").concat(t.srcB64));case 2:return n=e.sent,e.abrupt("return",n.blob());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Mt=function(e,t){return e.filter((function(e){var n=e.imageUniqueName===t,c=e.imageUniqueName==="".concat(t,"_thumb");return(n||c)&&URL.revokeObjectURL(e.url),!c&&!n}))},Et=function(e){var t=e.stepId,n=e.hideTrashIcon,c=gt(),a=c.state,r=c.handleChange,i=a.steps.find((function(e){return e.id===t})),s=Object(o.c)((function(e){return e.imagesToSave})),u=Object(o.b)(),l=function(){var e=Object(w.a)(g.a.mark((function e(n,c){var o,l,d,b,j,f,m,h,v,O,x,w,_;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object(Ce.a)(Object(Ce.a)({},i),{},Object(It.a)({},n,c)),"photo"!==n){e.next=30;break}if(l=Mt(s,i.imageUniqueName),""!==c){e.next=7;break}u(p(l)),e.next=30;break;case 7:return(d=St.a.createNewImage("image")).srcB64=c,e.next=11,St.a.normalizeImageSize(d);case 11:return b=e.sent,e.next=14,St.a.createImageThumbnail(b);case 14:return j=e.sent,e.next=17,Pt(b);case 17:return f=e.sent,e.next=20,Pt(j);case 20:m=e.sent,h=URL.createObjectURL(f),v=URL.createObjectURL(m),O=St.a.generateImageUniqueName("step-image"),x={imageUniqueName:O,url:h,mimeType:b.mimeType},w={imageUniqueName:"".concat(O,"_thumb"),url:v,mimeType:j.mimeType},o.imageUniqueName=O,l.push(x),l.push(w),u(p(l));case 30:(_=Object(ye.a)(a.steps).filter((function(e){return e.id!==t}))).push(o),r("steps",_);case 33:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{className:"collect-step",children:[Object(D.jsxs)("nav",{className:"collect-step__toolbar",children:[Object(D.jsxs)("h1",{className:"collect-step__count",children:["Step ",t]}),!n&&Object(D.jsx)("i",{className:"collect-step__icon-more",onClick:function(){!function(e){var t,n=Object(ye.a)(a.steps),c={id:0,title:"",photo:"",description:"",imageUniqueName:""};n=n.filter((function(t){var n=t.id===e;return n&&(c=t),!n}));var i=Mt(s,null===(t=c)||void 0===t?void 0:t.imageUniqueName);u(p(i)),n=n.map((function(t){var n;return n=t.id>e?t.id-1:t.id,Object(Ce.a)(Object(Ce.a)({},t),{},{id:n})})),r("steps",n)}(t)},children:Object(D.jsx)(R.a,{src:kt})})]}),Object(D.jsxs)("main",{className:"collect-step__content",children:[Object(D.jsx)(J,{value:i.title,onChange:function(e){l("title",e)},label:"Step title *",placeholder:"Step title",theme:"light",startCapital:!0}),Object(D.jsx)(yt,{base64:i.photo,onChange:function(e){l("photo",e)},slim:!0}),Object(D.jsx)(J,{value:i.description,onChange:function(e){l("description",e)},label:"Step description",placeholder:"Step description",theme:"light",multiline:!0,noMargin:!0})]})]})},qt=function(){var e,t=Object(a.useContext)($t),n=gt(),c=n.state,r=n.handleChange,i=function(){var e=c.steps.slice().sort((function(e,t){return e.id-t.id}));return""!==e[e.length-1].title},s=function(){var e=Object(ye.a)(c.steps),t=function(){var e=c.steps.slice().sort((function(e,t){return e.id-t.id}));return e[e.length-1].id}()+1;e.push({id:t,title:"",photo:"",description:"",imageUniqueName:""}),r("steps",e)},u=Object(o.c)((function(e){return e.imagesToSave})),l=Object(o.b)(),d=Object(a.useState)(""),b=Object(_.a)(d,2),j=b[0],f=b[1],m=function(){var e=Object(w.a)(g.a.mark((function e(t){var n,a,i,s,o,d,b,j,m,h,v;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Mt(u,c.coverPhoto),f(t),""===t){e.next=27;break}return(a=St.a.createNewImage("image")).srcB64=t,e.next=7,St.a.normalizeImageSize(a);case 7:return i=e.sent,e.next=10,St.a.createImageThumbnail(i);case 10:return s=e.sent,e.next=13,Pt(i);case 13:return o=e.sent,e.next=16,Pt(s);case 16:d=e.sent,b=URL.createObjectURL(o),j=URL.createObjectURL(d),m=St.a.generateImageUniqueName("step-image"),h={imageUniqueName:m,url:b,mimeType:i.mimeType},v={imageUniqueName:"".concat(m,"_thumb"),url:j,mimeType:s.mimeType},n.push(h),n.push(v),r("coverPhoto",m),e.next=28;break;case 27:r("coverPhoto","");case 28:l(p(n));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=Object(a.useMemo)((function(){return c.category?Object(D.jsx)("h2",{className:"collect-screen__category",children:c.category.name}):Object(D.jsx)(D.Fragment,{})}),[null===c||void 0===c||null===(e=c.category)||void 0===e?void 0:e.name]),v=Object(a.useMemo)((function(){return c.title?Object(D.jsx)("h1",{className:"collect-screen__title",children:c.title}):Object(D.jsx)(D.Fragment,{})}),[c.title]),O=Object(a.useMemo)((function(){return c.description?Object(D.jsx)("p",{className:"collect-screen__description",children:c.description}):Object(D.jsx)(D.Fragment,{})}),[c.description]),x=Object(a.useMemo)((function(){return Object(D.jsx)(D.Fragment,{children:c.steps.slice().sort((function(e,t){return e.id-t.id})).map((function(e){return Object(D.jsx)(Et,{stepId:e.id,hideTrashIcon:1===e.id},e.id)}))})}),[c.steps]),N=Object(a.useMemo)((function(){return i()?Object(D.jsx)(G,{onPress:s,theme:"inverted",children:"Add next step"}):Object(D.jsx)(D.Fragment,{})}),[i(),s]),k=function(){var e=Object(w.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t("step-3");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{className:"collect-screen__content",children:[Object(D.jsxs)("div",{className:"collect-screen__form",children:[Object(D.jsx)(yt,{base64:j,onChange:m}),h,v,O,x,N]}),Object(D.jsx)("span",{className:"collect-screen__spacer collect-screen__spacer--big"}),Object(D.jsx)(G,{onPress:k,disabled:!!c.steps.slice().find((function(e){return""===e.title.trim()})),children:"Preview & Send"}),Object(D.jsx)("span",{className:"collect-screen__spacer"}),Object(D.jsx)(G,{onPress:function(){t("step-1")},theme:"minimal",children:"Back"})]})},Tt=(n(179),function(e){var t=e.currentVal,n=e.maxVal,c="".concat(t,"/").concat(n),a="".concat((t/n*100).toFixed(0))+"%";return Object(D.jsxs)("h2",{className:"collect-progress",children:[Object(D.jsx)("span",{className:"collect-progress__step",children:c}),Object(D.jsx)("div",{className:"collect-progress__progress-line",children:Object(D.jsx)("span",{style:{width:a}})})]})}),Ut=n(224),Ft=(n(180),n(181),function(e){var t=e.submitClick,n=e.guide,c=Object(a.useState)(""),r=Object(_.a)(c,2),i=r[0],s=r[1],o=Object(a.useState)(3),u=Object(_.a)(o,2),l=u[0],d=u[1];return Object(D.jsxs)("div",{className:"review-modal",children:[Object(D.jsxs)("div",{className:"information",children:[Object(D.jsx)("div",{className:"user-photo",children:Object(D.jsx)(we,{fetchMethod:"byUniqueName",annotationName:null===n||void 0===n?void 0:n.imageUniqueName,isThumbnail:!1,placeholderIcon:De,hasFullscreenMode:!1})}),Object(D.jsx)("div",{className:"title",children:"Quick feedback"}),Object(D.jsx)("div",{className:"description",children:"Did this help you to solve your problem?"}),Object(D.jsx)("div",{className:"buttons",children:[{text:"Yes!",rating:3},{text:"Partially",rating:2},{text:"No",rating:1}].map((function(e){var t=e.text,n=e.rating,c=n===l?"selected":"inverted";return Object(D.jsx)(G,{onPress:function(){d(n)},theme:c,children:t},t)}))}),Object(D.jsx)(J,{value:i,onChange:function(e){s(e)},label:"Comment",placeholder:"Add your comments",theme:"light",startCapital:!0,multiline:!0,maxLength:2e3})]}),Object(D.jsx)("div",{className:"submit-button",children:Object(D.jsx)(G,{onPress:function(){n&&t({minrating:1,maxrating:3,comment:i,rating:l,regardingobjectid:n.id,title:n.name})},children:"Send feedback"})})]})}),Lt=Ft,Bt=n(232),Rt=(n(182),n(236)),At=function(e){var t=e.width,n=e.height;return Object(D.jsx)("div",{style:{height:n,width:t,display:"flex",justifyContent:"center",alignItems:"center",position:"relative",margin:"auto"},children:Object(D.jsx)(xe,{})})},Dt=function(e){var t=e.closeModal,n=e.pdfObject,c=Object(Le.a)(),a=c.width,r=c.height,i=c.ref;return n?Object(D.jsx)("div",{className:"pdf-viewer-modal",ref:i,children:Object(D.jsxs)("div",{className:"pdf-view",children:[n.loading&&Object(D.jsx)(At,{height:null!==r&&void 0!==r?r:"100%",width:null!==a&&void 0!==a?a:"100%"}),n.mediaUniqueName&&!n.error&&!n.loading&&Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(Rt.a,{pdfObjectUrl:n.objectURL,widthPx:null!==a&&void 0!==a?a:0,heightPx:r,loading:Object(D.jsx)(At,{height:null!==r&&void 0!==r?r:"100%",width:null!==a&&void 0!==a?a:"100%"}),onLoadError:function(e){return MobileCRM.bridge.alert("Load error: ".concat(null===e||void 0===e?void 0:e.message))}}),Object(D.jsx)("div",{className:"close-button",children:Object(D.jsx)(G,{onPress:t,children:"Close"})})]}),!n.loading&&n.error&&Object(D.jsx)("div",{className:"pdf-error",children:n.error.message})]})}):Object(D.jsx)("div",{children:"No PDF Document!"})},Gt=Dt,Ht=function(e){var t=e.imageUniqueName,n=e.style;return Object(D.jsx)(D.Fragment,{children:Object(D.jsx)(we,{style:n,fetchMethod:"byUniqueName",annotationName:t,isThumbnail:!1,placeholderIcon:De,hasFullscreenMode:!0})})},Wt=function(e){var t=e.imageUniqueName,n=e.style;return Object(D.jsx)(D.Fragment,{children:Object(D.jsx)(we,{style:n,fetchMethod:"byUniqueNameFromStore",annotationName:t,isThumbnail:!1,placeholderIcon:De,hasFullscreenMode:!1})})},zt=function(e){var t=e.regardingId;return Object(D.jsx)(D.Fragment,{children:Object(D.jsx)(we,{fetchMethod:"byIdAndName",annotationName:"UserImage",isThumbnail:!1,placeholderIcon:De,hasFullscreenMode:!1,annotationId:t})})},Vt=function(){var e=Object(a.useContext)(dn),t=Object(a.useContext)(bn).setFeedbackMessage,n=Object(o.b)(),r=Object(o.c)((function(e){return e.selectedGuide})),i=Object(o.c)((function(e){return e.categories})),s=Object(a.useState)(""),u=Object(_.a)(s,2),l=u[0],b=u[1],j=Object(a.useState)("hidden"),f=Object(_.a)(j,2),m=f[0],p=f[1],v=Object(a.useState)("hidden"),x=Object(_.a)(v,2),N=x[0],k=x[1],C=Object(a.useState)(!1),y=Object(_.a)(C,2),I=y[0],S=y[1],P=Object(a.useState)(0),M=Object(_.a)(P,2),E=M[0],q=M[1],T=Object(o.c)((function(e){return[e.pdfViewerObject]})),U=Object(_.a)(T,1)[0];Object(a.useEffect)((function(){r?q(window.setTimeout((function(){S(!0)}),1e4)):S(!1)}),[r]);var F=Object(a.useState)(!1),L=Object(_.a)(F,2),B=L[0],A=L[1],G=Object(a.useRef)(new fe),H="guide-detail__navbar ".concat(B&&"guide-detail__navbar--full"),z=V(),X=Object(a.useCallback)((function(){window.clearTimeout(E),I?p("visible"):Q()}),[I,E,z]),Q=function(){!O.getState().selectedEquipment||z===c.Landscape&&W()?e("tabbar-navigator"):e("equipment-navigator"),setTimeout((function(){n(d(null)),p("hidden")}),300)},J=function(){p("hidden"),Q()},Z=Object(a.useCallback)((function(n){J(),e("success-modal-toggle"),t(Xt()),G.current.saveFeedback(n)}),[]),K=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t){var c,a,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U&&U.mediaUniqueName===t){e.next=15;break}return k("visible"),n(h({mediaUniqueName:"",objectURL:"",loading:!0})),e.next=5,G.current.loadPDFByUniqueName(t);case 5:if(!(c=e.sent)){e.next=14;break}return e.next=9,Pt(c);case 9:a=e.sent,r=URL.createObjectURL(a),n(h({mediaUniqueName:c.imageUniqueName,objectURL:r,loading:!1})),e.next=15;break;case 14:n(h({mediaUniqueName:"",objectURL:"",loading:!1,error:new Error("Failed load the PDF document.")}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(a.useEffect)((function(){var e=i.find((function(e){return e.id===(null===r||void 0===r?void 0:r.categoryId)}));b(e?null===e||void 0===e?void 0:e.name:"")}),[r]),r?Object(D.jsx)("div",{style:{width:"100%"},children:Object(D.jsxs)("div",{className:"guide-detail",onScroll:function(e){var t;e.cancelable&&e.preventDefault();var n=null===(t=e.target.querySelector(".guide-player__information"))||void 0===t?void 0:t.querySelector("h1"),c=(null===n||void 0===n?void 0:n.getBoundingClientRect().top)||100;c<0&&!B?A(!0):c>0&&B&&A(!1)},children:[Object(D.jsx)("section",{children:Object(D.jsxs)("nav",{className:H,children:[Object(D.jsx)("i",{className:"guide-detail__icon-back",onClick:X,children:Object(D.jsx)(R.a,{src:Y})}),Object(D.jsx)("h1",{children:r.name||"No name found"}),Object(D.jsx)("span",{})]})}),Object(D.jsx)(Bt.a,{guide:r,usedInMobileApp:!0,imageComponent:Ht,categoryName:l,avatarComponent:zt,showPDFViewerAction:K}),Object(D.jsx)(lt.a,{anchor:"bottom",open:"visible"===m,PaperProps:{style:{backgroundColor:"transparent",alignItems:"center"}},children:Object(D.jsx)(dt,{contentWidthPercentage:z===c.Portrait?100:80,contentHeightPercentage:90,closeButtonText:"Skip",onCancelClick:J,roundedCorner:!0,children:Object(D.jsx)(Lt,{submitClick:Z,guide:r})})}),Object(D.jsx)(lt.a,{anchor:"bottom",open:"visible"===N,PaperProps:{style:{backgroundColor:"transparent",alignItems:"center"}},children:Object(D.jsx)(dt,{contentWidthPercentage:z===c.Portrait?100:80,contentHeightPercentage:100,closeButtonText:"Close",onCancelClick:function(){return k("hidden")},roundedCorner:!0,children:Object(D.jsx)(Gt,{closeModal:function(){return k("hidden")},pdfObject:U})})})]})}):Object(D.jsx)(D.Fragment,{})},Xt=function(){return Object(D.jsxs)("p",{className:"success-modal__p",children:["for making the guides better!",Object(D.jsx)("br",{}),"Please sync in settings",Object(D.jsx)("br",{})," to upload feedback to server."]})},Yt=n(230),Qt=n(235),Jt=function(e){return new Promise((function(t,n){var c=new XMLHttpRequest;c.open("GET",e),c.responseType="blob",c.onload=function(){if(200===c.status){var e=new FileReader;e.onloadend=function(){t(e.result.split(",")[1])},e.readAsDataURL(c.response)}else n(c.statusText)},c.send()}))},Zt=function(e){var t=e.isActive,n=e.onSendCallback,r=Object(a.useContext)($t),i=Object(a.useContext)(dn),s=gt().state,u=Object(a.useState)(),l=Object(_.a)(u,2),d=l[0],b=l[1],j=Object(o.c)((function(e){return e.imagesToSave})),f=Object(o.b)(),m=Object(o.c)((function(e){return[e.pdfViewerObject]})),v=Object(_.a)(m,1)[0],O=Object(a.useState)("hidden"),x=Object(_.a)(O,2),N=x[0],k=x[1];Object(a.useEffect)((function(){C()}),[t]);var C=function(){var e=Object(w.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,I(s);case 4:n=e.sent,b(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=Object(a.useRef)(new fe),I=function(){var e=Object(w.a)(g.a.mark((function e(t){var n,c,a,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=St.a.generateGuid(),e.next=3,he();case 3:return r=e.sent,i={id:a,name:t.title,description:t.description,logicalName:"",status:"active",statusReason:"collected",version:1,imageUniqueName:t.coverPhoto,steps:S(t.steps),authors:[r]},(null===t||void 0===t||null===(n=t.category)||void 0===n?void 0:n.id)&&(i.categoryId=t.category.id),(null===t||void 0===t||null===(c=t.equipment)||void 0===c?void 0:c.id)&&(i.equipmentList=[t.equipment]),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(e){return e.slice().sort((function(e,t){return e.id-t.id})).map((function(e){return{id:St.a.generateGuid(),title:e.title,description:e.description,imageUniqueName:e.imageUniqueName,content:[],mediaProperties:{fit:Ut.a.Cover}}}))},P=Object(a.useState)(!1),M=Object(_.a)(P,2),E=M[0],q=M[1],T=Object(a.useState)(0),U=Object(_.a)(T,2),F=U[0],L=U[1],B=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}throw new Error("No guide to publish");case 2:return q(!0),t=0,n=j.map(function(){var e=Object(w.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=y.current,e.t1=n.imageUniqueName,e.t2=d.id,e.next=5,Jt(n.url);case 5:e.t3=e.sent,e.t4=n.mimeType,e.t5=n.imageUniqueName,e.t6={imageUniqueName:e.t1,regardingId:e.t2,srcB64:e.t3,mimeType:e.t4,fileName:e.t5},e.t0.saveMedia.call(e.t0,e.t6),t++,L(100*t/j.length),URL.revokeObjectURL(n.url);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=7,Promise.all(n);case 7:return q(!1),f(p([])),e.next=11,y.current.saveGuide(d);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(w.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B();case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),MobileCRM.bridge.alert(e.t0),e.abrupt("return");case 9:n?n():i("success-modal-toggle");case 10:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),A=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t){var n,c,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v&&v.mediaUniqueName===t){e.next=15;break}return k("visible"),f(h({mediaUniqueName:"",objectURL:"",loading:!0})),e.next=5,y.current.loadPDFByUniqueName(t);case 5:if(!(n=e.sent)){e.next=14;break}return e.next=9,Pt(n);case 9:c=e.sent,a=URL.createObjectURL(c),f(h({mediaUniqueName:n.imageUniqueName,objectURL:a,loading:!1})),e.next=15;break;case 14:f(h({mediaUniqueName:"",objectURL:"",loading:!1,error:new Error("Failed load the PDF document.")}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),H=Object(o.c)((function(e){return e.categories})),W=Object(a.useState)(""),z=Object(_.a)(W,2),V=z[0],X=z[1];return Object(a.useEffect)((function(){var e=H.find((function(e){return e.id===(null===d||void 0===d?void 0:d.categoryId)}));e&&X(e.name)}),[d]),Object(D.jsxs)("div",{className:"collect-screen__content collect-screen--fullscreen",children:[Object(D.jsx)(Yt.a,{open:E,children:Object(D.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},children:Object(D.jsx)(Qt.a,{variant:"determinate",value:F})})}),d&&Object(D.jsx)(Bt.a,{guide:d,imageComponent:Wt,categoryName:V,avatarComponent:zt,showPDFViewerAction:A}),Object(D.jsx)(lt.a,{anchor:"bottom",open:"visible"===N,PaperProps:{style:{backgroundColor:"transparent",alignItems:"center"}},children:Object(D.jsx)(dt,{contentWidthPercentage:orientation===c.Portrait?100:80,contentHeightPercentage:100,closeButtonText:"Close",onCancelClick:function(){return k("hidden")},roundedCorner:!0,children:Object(D.jsx)(Gt,{closeModal:function(){return k("hidden")},pdfObject:v})})}),Object(D.jsxs)("div",{className:"collect-screen__end-buttons",children:[Object(D.jsx)("br",{}),Object(D.jsx)(G,{onPress:R,children:"Send"}),Object(D.jsx)("br",{}),Object(D.jsx)(G,{onPress:function(){r("step-2")},theme:"minimal",children:"Back"})]})]})},Kt=["step-1","step-2","step-3"],$t=Object(a.createContext)(void 0),en=function(e){var t=e.onSendCallback,n=Object(a.useState)("step-1"),c=Object(_.a)(n,2),r=c[0],i=c[1],s=Object(a.useCallback)((function(e){i(e)}),[]),o=Object(a.useMemo)((function(){return Kt.indexOf(r)}),[r]),u=Object(a.useCallback)((function(e){return e===r}),[r]),l=Object(a.useMemo)((function(){if("step-1"===r||"step-2"===r)return"Add new guide";if("step-3"===r)return"Preview & Send";throw new Error("Header not implemented")}),[r]);return Object(D.jsxs)($t.Provider,{value:s,children:[Object(D.jsx)(Tt,{currentVal:o+1,maxVal:Kt.length}),Object(D.jsx)("h1",{className:"collect-navigator__h1",children:l}),Object(D.jsxs)(B.a,{index:o,className:"collect-navigator",disabled:!0,children:[Object(D.jsx)(Nt,{}),Object(D.jsx)(qt,{}),Object(D.jsx)(Zt,{isActive:u("step-3"),onSendCallback:t})]})]})},tn=function(e){var t=e.onSendCallback,n=Object(ht.a)(Ot,vt),c=Object(_.a)(n,2),a=c[0],r=c[1];return Object(D.jsx)(xt.Provider,{value:{state:a,handleChange:function(e,t){r({key:e,payload:{newValue:t||null}})}},children:Object(D.jsx)(en,{onSendCallback:t})})},nn=["equipment-list","library-screen","calls-list"],cn=function(){var e=Object(a.useState)("equipment-list"),t=Object(_.a)(e,2),n=t[0],r=t[1],i=Object(a.useCallback)((function(e){r(e)}),[]),s=Object(a.useMemo)((function(){return nn.indexOf(n)}),[n]),o=V(),u=Object(a.useState)(!1),l=Object(_.a)(u,2),d=l[0],b=l[1];Object(a.useEffect)((function(){b(W()&&o===c.Landscape)}),[o]);var j=Object(a.useState)(!1),f=Object(_.a)(j,2),m=(f[0],f[1]),p=Object(a.useCallback)((function(){m(!0)}),[]),h=Object(a.useState)(!1),v=Object(_.a)(h,2),O=v[0],x=v[1],N=Object(a.useCallback)((function(){x(!0)}),[]),k=function(){var e=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new MobileCRM.UI.MessageBox("Delete draft?")).items=["Yes","No"],e.next=4,t.showAsync();case 4:if("Yes"!==e.sent){e.next=7;break}return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){var e=document.getElementById("overlay"),t=document.getElementById("overlay1");e&&e.addEventListener("click",(function(){m(!1)})),t&&t.addEventListener("click",(function(){Object(w.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:e.sent&&x(!1);case 4:case"end":return e.stop()}}),e)})))()}))}),[]);var C=Object(a.useCallback)((function(){x(!1)}),[]);return Object(D.jsxs)("div",{className:"tabbar-navigator__wrapper".concat(d?"--tablet":""),children:[Object(D.jsx)(re.a,{open:O,touch:!1,pullRight:!0,sidebarClassName:"tabbar-navigator__sidebar",sidebar:Object(D.jsx)("div",{className:"tabbar-navigator__collect-wrapper",children:O&&Object(D.jsx)(tn,{onSendCallback:C})}),overlayId:"overlay1"}),d&&Object(D.jsx)(at,{view:s,navigateTabBar:i,useTabletUI:d}),Object(D.jsxs)(B.a,{index:s,className:"tabbar-navigator".concat(d?"--tablet":""),disabled:!0,animateTransitions:!1,children:[d?Object(D.jsx)(pt,{onProfileClick:p}):Object(D.jsx)(Re,{}),Object(D.jsx)(Xe,{onProfileClickCallback:p,onPlusClickCallback:N}),Object(D.jsx)(nt,{onProfileClickCallback:p})]}),d||Object(D.jsx)(at,{view:s,navigateTabBar:i,useTabletUI:d})]})},an=(n(193),function(e){var t=e.children,n=e.imageUniqueName,c=e.stepIndex;return Object(D.jsxs)("div",{className:"step-preview",onClick:function(){var e=document.getElementById("step".concat(c)),t=document.getElementsByClassName("guide-detail")[0];null===t||void 0===t||t.scrollTo({behavior:"smooth",top:((null===e||void 0===e?void 0:e.offsetTop)||0)-60})},children:[Object(D.jsx)("div",{className:"step-preview__image-container",children:Object(D.jsx)(we,{fetchMethod:"byUniqueName",annotationName:n,isThumbnail:!0,placeholderIcon:De,hasFullscreenMode:!1})}),Object(D.jsxs)("div",{className:"step-preview__content",children:[Object(D.jsxs)("span",{className:"step-preview__index",children:["Step ",c]}),Object(D.jsx)("span",{className:"step-preview__title",children:t})]})]})}),rn=Vt,sn=(n(194),function(){var e=Object(o.c)((function(e){return e.selectedGuide})),t=V(),n=W()&&t===c.Landscape,r=Object(a.useMemo)((function(){return Object(D.jsx)(D.Fragment,{children:null===e||void 0===e?void 0:e.steps.map((function(e,t){return Object(D.jsx)(an,{imageUniqueName:e.imageUniqueName,stepIndex:t+1,children:e.title})}))})}),[e]);return Object(D.jsxs)("div",{className:"guide-detail-tablet",children:[n&&Object(D.jsxs)("div",{className:"guide-detail-tablet__side-navigator",children:[Object(D.jsx)("h1",{children:"Content"}),Object(D.jsx)("div",{className:"guide-detail-tablet__introduction",onClick:function(){var e=document.getElementById("introduction"),t=document.getElementsByClassName("guide-detail")[0];null===t||void 0===t||t.scrollTo({behavior:"smooth",top:((null===e||void 0===e?void 0:e.offsetTop)||0)-70})},children:"Introduction"}),Object(D.jsx)("hr",{className:"guide-detail-tablet__separator"}),Object(D.jsx)("div",{className:"guide-detail-tablet__previews-container",children:r})]}),Object(D.jsx)(rn,{})]})}),on=(n(195),n.p+"static/media/check-circle.eb2863fa.svg"),un=function(e){var t=e.FeedbackMessage;return t?Object(D.jsx)("span",{children:t}):Object(D.jsxs)("p",{className:"success-modal__p",children:["for sharing your wisdom!",Object(D.jsx)("br",{}),"Please sync in settings",Object(D.jsx)("br",{})," to upload guide to server."]})},ln=function(e){var t=e.onCloseClickCallback,n=Object(a.useContext)(dn),c=Object(a.useContext)(bn),r=c.feedbackMessage,i=c.setFeedbackMessage;return Object(D.jsxs)("div",{className:"success-modal__popup",children:[Object(D.jsx)("i",{className:"success-modal__icon-check-circle",children:Object(D.jsx)(R.a,{src:on})}),Object(D.jsx)("h1",{className:"success-modal__h1",children:" Thank you"}),Object(D.jsx)(un,{FeedbackMessage:r}),Object(D.jsx)(G,{onPress:function(){t?t():n("success-modal-toggle"),i(void 0)},children:"Close"})]})},dn=Object(a.createContext)(void 0),bn=Object(a.createContext)(void 0),jn=function(){var e=Object(o.c)((function(e){return e.selectedEquipment})),t=Object(o.c)((function(e){return e.selectedGuide})),n=Object(o.b)(),r=Object(a.useState)("tabbar-navigator"),i=Object(_.a)(r,2),s=i[0],u=i[1],l=Object(a.useState)("hidden"),b=Object(_.a)(l,2),j=b[0],f=b[1],m=Object(a.useState)("hidden"),p=Object(_.a)(m,2),h=p[0],v=p[1],O=V(),x=Object(a.useState)(),N=Object(_.a)(x,2),k=N[0],C=N[1];Object(a.useEffect)((function(){var t=W()&&O===c.Landscape;e&&"guide-detail"!==s&&S(t?"tabbar-navigator":"equipment-navigator")}),[e,O]),Object(a.useEffect)((function(){t&&S("guide-detail")}),[t]),Object(a.useEffect)((function(){ee("main-navigator",y)}),[s]);var y=function(){"guide-detail"===s&&(S("equipment-navigator"),setTimeout((function(){n(d(null))}),300))},I=function(){var e=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new MobileCRM.UI.MessageBox("Delete draft?")).items=["Yes","No"],e.next=4,t.showAsync();case 4:if("Yes"!==e.sent){e.next=7;break}return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=Object(a.useCallback)(function(){var e=Object(w.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("fullscreen-modal-toggle"!==t){e.next=12;break}if(n="visible"===j?"hidden":"visible",e.t0="hidden"===n,!e.t0){e.next=7;break}return e.next=6,I();case 6:e.t0=!e.sent;case 7:if(!e.t0){e.next=9;break}return e.abrupt("return");case 9:f(n),e.next=13;break;case 12:"success-modal-toggle"===t?(v("visible"===h?"hidden":"visible"),f("hidden")):u(t);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[j,h]);return Object(D.jsx)(dn.Provider,{value:S,children:Object(D.jsxs)(bn.Provider,{value:{feedbackMessage:k,setFeedbackMessage:C},children:[Object(D.jsx)(cn,{}),Object(D.jsx)(lt.a,{anchor:"right",open:"guide-detail"===s,PaperProps:{style:{backgroundColor:"transparent",overflow:"hidden"}},children:Object(D.jsx)(dt,{contentHeightPercentage:100,contentWidthPercentage:100,children:Object(D.jsx)("div",{children:Object(D.jsx)(sn,{})})})}),Object(D.jsx)(lt.a,{anchor:"right",open:"equipment-navigator"===s,PaperProps:{style:{backgroundColor:"transparent"}},children:Object(D.jsx)(dt,{contentHeightPercentage:100,contentWidthPercentage:100,children:Object(D.jsx)("div",{children:Object(D.jsx)(mt,{})})})}),Object(D.jsx)(lt.a,{anchor:"bottom",open:"visible"===j,PaperProps:{style:{backgroundColor:"transparent"}},children:Object(D.jsx)(dt,{closeButtonText:"Cancel",contentHeightPercentage:100,contentWidthPercentage:100,roundedCorner:!0,onCancelClick:function(){return S("fullscreen-modal-toggle")},children:Object(D.jsx)("div",{children:Object(D.jsx)(tn,{})})})}),Object(D.jsx)(lt.a,{anchor:"bottom",open:"visible"===h,PaperProps:{style:{backgroundColor:"transparent",alignItems:"center"}},children:Object(D.jsx)(dt,{contentHeightPercentage:O===c.Portrait?50:80,contentWidthPercentage:O===c.Portrait?100:80,roundedCorner:!0,onCancelClick:function(){return S("fullscreen-modal-toggle")},children:Object(D.jsx)(ln,{onCloseClickCallback:function(){return v("hidden")}})})})]})})},fn=r.a.memo(jn),mn=(n(196),n.p+"static/media/logout.749f26b5.svg"),pn=n.p+"static/media/sync.60541be2.svg",hn=(n(197),function(e){var t=e.title,n=e.iconPath,c=e.onClick;return Object(D.jsxs)("div",{className:"profile-action",onClick:c,children:[Object(D.jsx)("i",{className:"profile-action__icon","data-test":"ProfileList",children:Object(D.jsx)(R.a,{src:n})}),Object(D.jsx)("span",{className:"profile-action__title",children:t}),Object(D.jsx)("i",{className:"profile-action__chevron-right",children:Object(D.jsx)(R.a,{src:A})})]})}),vn=function(e){var t,n,c=e.showBackButton,r=Object(a.useContext)(xn),i=Object(a.useState)(null),s=Object(_.a)(i,2),o=s[0],u=s[1];Object(a.useEffect)((function(){l()}),[]);var l=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:return t=e.sent,e.next=5,d();case 5:return n=e.sent,e.next=8,q();case 8:c=e.sent,u({appVersion:t,profileInfo:n,isLoggedIn:c});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){_e.Configuration.requestObject((function(t){e(t.applicationVersion)}),(function(e){t(e)}))}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=Object(a.useCallback)(Object(w.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f();case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:if(!(null===o||void 0===o?void 0:o.isLoggedIn)){e.next=9;break}return e.next=9,new Promise((function(e,t){M.bridge.invokeStaticMethodAsync("MobileCrm","MobileCrm.Controllers.LoginForm","LogoutUser",[null,null,!0],(function(){e()}),(function(e){t(e)}))}));case 9:r("login-navigator"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),MobileCRM.bridge.alert(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),[null===o||void 0===o?void 0:o.isLoggedIn]),f=function(){var e=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new MobileCRM.UI.MessageBox("Log Out?")).items=["Yes","No"],e.next=4,t.showAsync();case 4:if("Yes"!==e.sent){e.next=7;break}return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=Object(a.useCallback)(Object(w.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I();case 1:case"end":return e.stop()}}),e)}))),[]);return o?Object(D.jsxs)("div",{className:"profile-screen",children:[Object(D.jsx)("nav",{className:"profile-screen__navbar",children:c&&Object(D.jsx)("i",{className:"profile-screen__icon-back",onClick:function(){r("main-navigator")},"data-test":"BackButton",children:Object(D.jsx)(R.a,{src:Y})})}),Object(D.jsxs)("section",{className:"profile-screen__jumbotron",children:[Object(D.jsx)("i",{className:"profile-screen__image",children:Object(D.jsx)(we,{fetchMethod:"byIdAndName",annotationId:o.profileInfo.id,annotationName:"UserImage",isThumbnail:!0,placeholderIcon:me,hasFullscreenMode:!1})}),Object(D.jsx)("h1",{className:"profile-screen__name",children:null===(t=o.profileInfo)||void 0===t?void 0:t.name}),Object(D.jsx)("h2",{className:"profile-screen__position",children:null===(n=o.profileInfo)||void 0===n?void 0:n.position})]}),Object(D.jsxs)("section",{className:"profile-screen__actions",children:[Object(D.jsx)(hn,{title:"Log Out",iconPath:mn,onClick:j}),o.isLoggedIn&&Object(D.jsx)(hn,{title:"Sync",iconPath:pn,onClick:m}),Object(D.jsxs)("span",{className:"profile-screen__app-version",children:["v",o.appVersion," ","15.0.0"]})]})]}):Object(D.jsx)("div",{})},On=r.a.memo(vn),xn=Object(a.createContext)(void 0),gn=function(){var e=Object(a.useState)("login-navigator"),t=Object(_.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(100),s=Object(_.a)(i,2),o=s[0],u=s[1],l=V();Object(a.useEffect)((function(){if(W()){var e=l===c.Landscape?30:100;u(e)}}),[l]),Object(a.useEffect)((function(){b()}),[]),Object(a.useEffect)((function(){ee("root-navigator",d)}),[n]);var d=function(){"profile-screen"===n&&j("main-navigator")},b=function(){var e=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:t=e.sent,r(t?"main-navigator":"login-navigator");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=Object(a.useCallback)((function(e){r(e)}),[]);return Object(D.jsxs)(xn.Provider,{value:j,children:[Object(D.jsx)(lt.a,{anchor:"bottom",open:"login-navigator"===n,PaperProps:{style:{backgroundColor:"transparent"}},children:Object(D.jsx)(dt,{contentWidthPercentage:100,contentHeightPercentage:100,children:Object(D.jsx)(ae,{})})}),Object(D.jsx)(fn,{}),Object(D.jsx)(lt.a,{anchor:"left",open:"profile-screen"===n,onClose:function(){return j("main-navigator")},PaperProps:{style:{backgroundColor:"transparent"}},children:Object(D.jsx)(dt,{contentHeightPercentage:100,contentWidthPercentage:o,children:Object(D.jsx)(On,{showBackButton:!(l===c.Landscape&&W())})})})]})},wn=function(e){window.handleLaunch=e},_n=function(){var e=Object(o.b)();Object(a.useEffect)((function(){wn((function(e){var a=t(e),i=Object(_.a)(a,2),s=i[0],o=i[1];q()?"fs_asset"===s?n(o):"rh_guide"===s&&c(o):r()}))}),[]);var t=function(e){var t=e.split(";"),n=Object(_.a)(t,2);return[n[0],n[1]]},n=function(){var t=Object(w.a)(g.a.mark((function t(n){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(new fe).loadEquipmentById(n).then((function(t){e(l(t))})).catch((function(){MobileCRM.bridge.alert("Equipment not found")}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),c=function(){var t=Object(w.a)(g.a.mark((function t(n){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(new fe).loadGuideById(n).then((function(t){e(d(t))})).catch((function(){MobileCRM.bridge.alert("Equipment not found")}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r=function(){MobileCRM.bridge.alert("Log In to see content")};return null},Nn=(n(198),function(){return Object(D.jsx)("div",{className:"loading-screen"})}),kn=n(43),Cn=(n(199),function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.zoomAnnotation}));return t?Object(D.jsxs)("section",{className:"pinchable-image",children:[Object(D.jsx)("i",{className:"pinchable-image__icon-close",onClick:function(){e(j(null))}}),Object(D.jsx)(kn.b,{velocityAnimation:{disabled:!0},centerOnInit:!0,children:function(e){var n=e.zoomOut;return Object(D.jsx)(kn.a,{wrapperClass:"pinchable-image__wrapper",children:Object(D.jsx)(we,{fetchMethod:t.fetchMethod,annotationName:t.annotationName,annotationId:t.annotationId,isThumbnail:!1,placeholderIcon:null,hasFullscreenMode:!1,onImageLoad:function(){return n(0,0,"easeOut")}})})}})]}):Object(D.jsx)(D.Fragment,{})}),yn=function(){var e=Object(a.useState)(!1),t=Object(_.a)(e,2),n=t[0],c=t[1],r=Object(o.b)();Object(a.useEffect)((function(){n||(MobileCRM.bridge.enableDebug(),C.a.polyfill(),i(),u(),s())}),[n]);var i=function(){var e=Object(w.a)(g.a.mark((function e(){var t,n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new fe,e.prev=1,e.next=4,t.loadAllCategories();case 4:return n=e.sent,e.next=7,t.loadAllEquipment();case 7:c=e.sent,r(f(c)),r(m(n)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),MobileCRM.bridge.alert(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),s=function(){MobileCRM.Platform.preventBackButton((function(){}))},u=function(){var e;e=function(){c(!0)},y.bridge.onGlobalEvent("SyncStarted",e,!0),function(e){y.bridge.onGlobalEvent("SyncFinished",e,!0)}((function(){c(!1)}))};return Object(D.jsx)(D.Fragment,{children:n?Object(D.jsx)(Nn,{}):Object(D.jsxs)("div",{className:"App",children:[Object(D.jsx)(gn,{}),Object(D.jsx)(N.a,{limit:1}),Object(D.jsx)(Cn,{}),Object(D.jsx)(_n,{})]})})},In=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,237)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};s.a.render(Object(D.jsx)(r.a.StrictMode,{children:Object(D.jsx)(o.a,{store:O,children:Object(D.jsx)(yn,{})})}),document.querySelector("#root")),In()}]),[[200,1,2]]]);
//# sourceMappingURL=main.f857ab1f.chunk.js.map